<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Demo</title>
</head>
<body>
    <a href="http://jquery.com/">jQuery</a>
    <script src="jquery.min.js"></script>
    <div id="buttons1">
      <button id="button1">11</button>
      <button id="button2">12</button>
    </div>
    <div id="buttons2">
      <button>21</button>
      <button>22</button>
    </div>
    <div id="buttons3">
      <button>31</button>
      <button>32</button>
    </div>
    <script>
    console.log("this is", this)

    $( "#buttons1" ).find('button').each(function( index ) {
        console.log("this is", this)
        console.log( index + ": " + $( this ).text() );
        $(this).on("click", function(){
          console.log("clicked",$(this).text());
          return false;
        });
    });
    //wrong value of i is obtained
    var $twobuttons = $( "#buttons2" ).find('button');
    console.log("twobuttons",$twobuttons);
    for(i=0;i<$twobuttons.length;i++){
        // loop does not do the i matching
      $($twobuttons[i]).click(function(){
         console.log("this is", this)
        console.log("clicked in second row",i, "text", $(this).text());
        return false;
      });
    }
    // create a closure to capture i
    mycallbackmaker = function (i) {
      return function(){
        console.log("this in function returned from mycallbackmaker", this)
        console.log("clicked in third row",i, "text", $(this).text());
        return false;
      }
    };
    $threebuttons = $( "#buttons3" ).find('button');
    console.log("threebuttons",$threebuttons);
    for(i=0;i<$threebuttons.length;i++){
        //get the right this and the right i
      $($threebuttons[i]).click(mycallbackmaker(i));
    }
    </script>
</body>
</html>
